import{_ as i,c as a,a2 as n,o as t}from"./chunks/framework.C0utc8P3.js";const c=JSON.parse('{"title":"sn-e-scankit 强大的uni-app扫码插件","description":"","frontmatter":{},"headers":[],"relativePath":"jsText/scankit.md","filePath":"jsText/scankit.md","lastUpdated":null}'),l={name:"jsText/scankit.md"};function e(h,s,p,k,d,r){return t(),a("div",null,s[0]||(s[0]=[n(`<h1 id="sn-e-scankit-强大的uni-app扫码插件" tabindex="-1">sn-e-scankit 强大的uni-app扫码插件 <a class="header-anchor" href="#sn-e-scankit-强大的uni-app扫码插件" aria-label="Permalink to &quot;sn-e-scankit 强大的uni-app扫码插件&quot;">​</a></h1><h2 id="_1-插件介绍" tabindex="-1">1. 插件介绍 <a class="header-anchor" href="#_1-插件介绍" aria-label="Permalink to &quot;1. 插件介绍&quot;">​</a></h2><p><code>sn-e-scankit</code> 是一个基于华为统一扫码服务（Scan Kit）封装的扩展插件，它在常规扫码场景以及复杂扫码场景（如反光、暗光、污损、小码、大角度等）中都有优异的表现。该插件提供基础的 Default View 模式，支持相机扫码和导入图片扫码，但不支持自定义扫码界面。</p><h2 id="_2-安装插件" tabindex="-1">2. 安装插件 <a class="header-anchor" href="#_2-安装插件" aria-label="Permalink to &quot;2. 安装插件&quot;">​</a></h2><p>在 uni-app 项目中，你可以通过插件市场直接安装<code>sn-e-scankit</code>插件。安装完成后，在你的页面中引入并使用该插件。</p><h2 id="_3-基本使用" tabindex="-1">3. 基本使用 <a class="header-anchor" href="#_3-基本使用" aria-label="Permalink to &quot;3. 基本使用&quot;">​</a></h2><h3 id="_3-1-扫码功能" tabindex="-1">3.1 扫码功能 <a class="header-anchor" href="#_3-1-扫码功能" aria-label="Permalink to &quot;3.1 扫码功能&quot;">​</a></h3><p>以下是使用<code>sn-e-scankit</code>插件进行扫码的基本示例：</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 引入插件</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { scan, ScanConfigs, ScanResult } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;@/uni_modules/sn-e-scankit&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 调用扫码</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">scan</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ScanConfigs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">res</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ScanResult</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  uni.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">showModal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    title: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;扫码结果&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    content: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\`格式：\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">res</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">format</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">数据：\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">res</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">data</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><h3 id="_3-2-扫码配置" tabindex="-1">3.2 扫码配置 <a class="header-anchor" href="#_3-2-扫码配置" aria-label="Permalink to &quot;3.2 扫码配置&quot;">​</a></h3><p><code>ScanConfigs</code> 类型允许你配置扫码的相关参数，例如扫码类型、标题类型和权限请求提示语：</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ScanConfigs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  scanTypes</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ScanTypes</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  titleType</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> titleType</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  permTip</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><h3 id="_3-3-扫码结果" tabindex="-1">3.3 扫码结果 <a class="header-anchor" href="#_3-3-扫码结果" aria-label="Permalink to &quot;3.3 扫码结果&quot;">​</a></h3><p>扫码结果<code>ScanResult</code>包含了扫描结果的格式和数据：</p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ScanResult</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  format</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ScanResultFormat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  data</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><h2 id="_4-兼容性" tabindex="-1">4. 兼容性 <a class="header-anchor" href="#_4-兼容性" aria-label="Permalink to &quot;4. 兼容性&quot;">​</a></h2><p><code>sn-e-scankit</code>插件在 Android 平台上支持，而 Web 平台不支持。</p><h2 id="_5-进阶使用" tabindex="-1">5. 进阶使用 <a class="header-anchor" href="#_5-进阶使用" aria-label="Permalink to &quot;5. 进阶使用&quot;">​</a></h2><h3 id="_5-1-生成码图" tabindex="-1">5.1 生成码图 <a class="header-anchor" href="#_5-1-生成码图" aria-label="Permalink to &quot;5.1 生成码图&quot;">​</a></h3><p><code>sn-e-scankit</code>还支持将字符串转换为一维码或二维码，支持多种码制式。以下是生成码图的示例：</p><div class="language-vue vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">sn-e-scankit-code</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    data</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Hello, world!&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    style</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;width: 100px;height: 100px;&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  &gt;&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">sn-e-scankit-code</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><h3 id="_5-2-属性配置" tabindex="-1">5.2 属性配置 <a class="header-anchor" href="#_5-2-属性配置" aria-label="Permalink to &quot;5.2 属性配置&quot;">​</a></h3><p>在生成码图时，你可以配置以下属性：</p><ul><li><code>data</code>: 需要编码的数据</li><li><code>type</code>: 码图类型</li><li><code>margin</code>: 码图边距</li><li><code>bgColor</code>: 码图背景颜色</li><li><code>frontColor</code>: 码图前景颜色</li><li><code>qrErrorLevel</code>: 二维码错误容错级别</li><li><code>qrLogo</code>: 二维码中间的 Logo 图片路径。</li></ul><h2 id="_6-注意事项" tabindex="-1">6. 注意事项 <a class="header-anchor" href="#_6-注意事项" aria-label="Permalink to &quot;6. 注意事项&quot;">​</a></h2><p>在使用<code>sn-e-scankit</code>插件之前，请确保你的应用已经申请了必要的权限，如相机、存储等权限。</p><p>在 HBuilderX 的某些版本中，使用 UTS 插件时可能会遇到回调函数重复触发的问题。这种情况通常会导致应用出现内存泄漏或者不必要的性能开销。</p><h4 id="对于-hbuilderx-4-25-版本及以后" tabindex="-1">对于 HBuilderX 4.25 版本及以后 <a class="header-anchor" href="#对于-hbuilderx-4-25-版本及以后" aria-label="Permalink to &quot;对于 HBuilderX 4.25 版本及以后&quot;">​</a></h4><p>在 HBuilderX 4.25 版本及以后的版本中，<code>UTS插件</code> 导出的方法中的回调函数参数默认触发一次后立即自动回收，以避免内存泄漏。如果你需要回调函数参数支持持续触发，可以按照以下方案进行适配：</p><ol><li><p><strong>方法名称调整</strong>：将方法名称调整为以 <code>on</code> 开头，且仅有一个 <code>callback</code> 类型的参数。这种方式可以让回调函数持续触发。</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 示例：调整方法名称</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">onScanResult</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(callback) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 方法实现</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li><li><p><strong>使用装饰器 <code>@UTSJS.keepAlive</code></strong>：HBuilderX 4.27 版本新增了装饰器 <code>@UTSJS.keepAlive</code>，通过这个装饰器声明方法中的回调函数参数一直存活（不自动回收），从而支持回调函数可持续触发回调。</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 示例：使用装饰器</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">UTSJS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.keepAlive</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> onScanResult</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">callback</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 方法实现</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p><strong>注意事项</strong>：</p><ul><li>如果使用了 <code>@UTSJS.keepAlive</code> 装饰器，则该方法参数里的所有回调都会在内存中持续存在，需要提醒使用者避免频繁调用此方法。</li><li>目前装饰器不支持 <code>export const test: Test = () =&gt; {}</code> 这种导出方式，需要使用 <code>export function test() {}</code>。</li><li>如果同时存在 <code>app-android/app-ios</code>，需要两个平台都同时配置 <code>@UTSJS.keepAlive</code>。</li></ul></li></ol><h4 id="其他注意事项" tabindex="-1">其他注意事项 <a class="header-anchor" href="#其他注意事项" aria-label="Permalink to &quot;其他注意事项&quot;">​</a></h4><ul><li><strong>避免函数重载</strong>：在 Uni-app 项目 Android 环境中不支持函数重载。如果同时存在两个同名函数，仅参数个数/类型不同，在 Android 环境中会无法正确区分两个函数。临时解决办法是以不同的函数名称来区分函数。</li></ul>`,32)]))}const E=i(l,[["render",e]]);export{c as __pageData,E as default};
